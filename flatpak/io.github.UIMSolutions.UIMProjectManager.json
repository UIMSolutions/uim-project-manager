{
    "app-id": "io.github.UIMSolutions.UIMProjectManager",
    "runtime": "org.gnome.Platform",
    "runtime-version": "46",
    "sdk": "org.gnome.Sdk",
    "command": "uim-project-manager",
    "finish-args": [
        "--share=ipc",
        "--socket=fallback-x11",
        "--socket=wayland",
        "--device=dri",
        "--filesystem=xdg-documents"
    ],
    "cleanup": [
        "/include",
        "/lib/pkgconfig",
        "/share/man",
        "*.a"
    ],
    "modules": [
        {
            "name": "dmd",
            "buildsystem": "simple",
            "build-commands": [
                "mkdir -p /app/bin /app/lib /app/include/d /app/etc",
                "install -Dm755 linux/bin64/dmd /app/bin/dmd",
                "cp -r linux/lib64/* /app/lib/",
                "cp -r src/druntime /app/include/d/",
                "cp -r src/phobos /app/include/d/",
                "echo '[Environment]' > /app/etc/dmd.conf",
                "echo 'DFLAGS=-I/app/include/d/phobos -I/app/include/d/druntime/import -L-L/app/lib' >> /app/etc/dmd.conf",
                "ln -sf /app/etc/dmd.conf /etc/dmd.conf"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://downloads.dlang.org/releases/2.x/2.111.0/dmd.2.111.0.linux.tar.xz",
                    "sha256": "63bd32222b51a406e365904aea6761cd4de3cb1de02f003a370b5961196caa77"
                }
            ]
        },
        {
            "name": "dub",
            "buildsystem": "simple",
            "build-commands": [
                "/app/bin/dmd -fPIC -I/app/include/d/phobos -I/app/include/d/druntime/import -L-L/app/lib -run build.d",
                "install -Dm755 bin/dub /app/bin/dub"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/dlang/dub/archive/refs/tags/v1.38.1.tar.gz",
                    "sha256": "a7c9a2f819fdea7359f298cba76e81a24ca1536d756c3b4b98c2480463c37907"
                }
            ]
        },
        {
            "name": "uim-project-manager",
            "buildsystem": "simple",
            "build-commands": [
                "dub build --build=release --compiler=/app/bin/dmd",
                "install -Dm755 uim-project-manager /app/bin/uim-project-manager",
                "install -Dm644 io.github.UIMSolutions.UIMProjectManager.desktop /app/share/applications/io.github.UIMSolutions.UIMProjectManager.desktop",
                "install -Dm644 io.github.UIMSolutions.UIMProjectManager.metainfo.xml /app/share/metainfo/io.github.UIMSolutions.UIMProjectManager.metainfo.xml"
            ],
            "sources": [
                {
                    "type": "dir",
                    "path": ".."
                }
            ]
        }
    ]
}
